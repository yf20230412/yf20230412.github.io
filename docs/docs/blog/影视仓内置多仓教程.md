# æ–°å»º `newxd` ç±»ååŠè°ƒç”¨æ–¹æ³•è¯´æ˜


## ğŸ§© ä¸€ã€æ–°å»º `newxd` ç±»å

###  æœç´¢ä¸å®šä½

#### 1. **æœç´¢å…³é”®è¯**ï¼š
   - åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æœç´¢ `æ‰«ç è¿œç¨‹æ¨é€`ã€‚
   - æœç´¢ç±»å‹é€‰æ‹© `ä»£ç `ã€‚

#### 2. **ç»§ç»­æŸ¥æ‰¾ç‚¹å‡»ç›‘å¬å™¨**ï¼š
   - å†æ¬¡æœç´¢ `setOnClickListener`ã€‚
   - é€‰æ‹©è·ç¦» `æ‰«ç è¿œç¨‹æ¨é€` æœ€è¿‘çš„ä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆé€šå¸¸æ˜¯ç¬¬ä¸‰ä¸ªï¼‰ã€‚

#### 3. **è·³è½¬åˆ°ç±»å¹¶å¤åˆ¶ä»£ç **ï¼š
   - åŒå‡» `Lcom/androidx/xd;-><init>` è·³è½¬åˆ° `xd` ç±»ã€‚
   - å…¨é€‰å¹¶å¤åˆ¶è¯¥ç±»ä»£ç ã€‚

#### 4. **é‡å‘½åç±»**ï¼š
   - ç‚¹å‡»é¡µé¢å·¦ä¸Šè§’çš„ `xd`ã€‚
   - ç‚¹å‡»â€œå®šä½â€ã€‚
   - é•¿æŒ‰ `xd`ï¼Œé€‰æ‹©â€œæ·»åŠ ç±»åâ€ï¼Œè¾“å…¥æ–°ç±»å `newxd`ã€‚
   - è¿›å…¥ `newxd` ç±»å¹¶ç²˜è´´ä¹‹å‰å¤åˆ¶çš„ä»£ç ã€‚

---

### ä»£ç ä¿®æ”¹ä¸ä¼˜åŒ–

#### 1. æ›¿æ¢ç±»å
- å°†æ‰€æœ‰ `xd` æ›¿æ¢ä¸º `newxd`ã€‚

#### 2. åˆ é™¤æ— ç”¨ä»£ç æ®µï¼š

| è¡Œå· | åŸå§‹ä»£ç  |
|------|----------|
| ç¬¬8è¡Œ | `.implements Landroid/view/View$OnClickListener;` |
| ç¬¬10è¡Œ | `.field public final synthetic a:I` |

#### 3. ä¿®æ”¹æ–¹æ³•åä¸å‚æ•°ï¼š

- åŸï¼š`.method public synthetic constructor <init>(Ljava/lang/Object;I)V`
- å»æ‰`I`æ”¹ä¸ºï¼š`.method public synthetic constructor <init>(Ljava/lang/Object;)V`

#### 4. åˆ é™¤å¯„å­˜å™¨å‚æ•° `I` ç›¸å…³å†…å®¹
- åˆ é™¤ç¬¬22è¡Œï¼š`iput p2, p0, Lcom/androidx/newxd;->a:I`

#### 5. ä¿®æ”¹ `onClick` æ–¹æ³•ä¸º `autoupdate()`å¹¶å»æ‰æ‹¬å·å†…æ‰€æœ‰å†…å®¹ï¼š

- åŸï¼š`.method public final onClick(Landroid/view/View;)V`
- æ”¹ä¸ºï¼š`.method public final autoupdate()V`

#### 6. åˆ é™¤ä»¥ä¸‹å†…å®¹ï¼š

- åˆ é™¤ `const-string v3, "this$0"` åŠå…¶ä¸Šæ–¹æ‰€æœ‰ä»£ç ã€‚
- åˆ é™¤ `packed-switch v0, :pswitch_data_11a` åŒºåŸŸã€‚
- ä¿ç•™ `iget-object v4, p0, Lcom/androidx/xd;->b:Ljava/lang/Object;`
- åˆ é™¤ä» `check-cast v4, Lcom/github/tvbox/osc/ui/view/PlayerMoreFucPop;` åˆ°ç¬¬ä¸€ä¸ª `new-instance v1, Lcom/androidx/ek0;` **ä¸­é—´**çš„æ‰€æœ‰ä»£ç ã€‚
- åˆ é™¤ `:goto_8c` æ ‡ç­¾åŠå…¶åçš„å†…å®¹ï¼Œä¿ç•™ `return-void`ã€‚

- ç´§æ¥ç€åˆ é™¤  `return-void`åé¢ä¸€ç›´åˆ°æœ€åé¢`.end method` **ä¸­é—´**å…¨éƒ¨ä»£ç 

#### 7. æ›¿æ¢ `check-cast` ä¸­çš„ç›®æ ‡ç±»

- æ ¹æ®æœ€åé¢å€’æ•°ç¬¬ä¸‰è¡Œ`handleRemotePush`ä¸­çš„` Lcom/androidx/tt0`;

```smali
invoke-virtual {v4, v1}, Lcom/androidx/tt0;->handleRemotePush(Lcom/androidx/ek0;)V " 
```
å°† `check-cast v4, Lcom/github/tvbox/osc/ui/view/PlayerMoreFucPop;` æ›¿æ¢ä¸ºï¼š
  
```smali
check-cast v4, Lcom/androidx/tt0;
```

---

### 8. æ·»åŠ è‡ªå®šä¹‰æ¥å£é€»è¾‘

åœ¨ `.method public final autoupdate()V` ä¸‹æ–¹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š

```smali
    const-string/jumbo v3, "æ¥å£åç§°"
    const-string v5, "æ­¤å¤„å¡«å…¥å¤šä»“æ¥å£URLé“¾æ¥"
```

æ›´æ”¹ä¸‹é¢`v0`å’Œ`p1` å¯„å­˜å™¨å’Œä¸Šé¢çš„`v3`å’Œ`v5`ä¸€ä¸€å¯¹åº”ï¼Œæ›´æ”¹åçš„æ•ˆæœï¼š

```
    invoke-virtual {v2, v3}, Lcom/github/tvbox/osc/bean/MoreSourceBean;->setSourceName(Ljava/lang/String;)V

    .line 133
    invoke-virtual {v2, v5}, Lcom/github/tvbox/osc/bean/MoreSourceBean;->setSourceUrl(Ljava/lang/String;)V
```
::: danger âš ï¸æ³¨æ„äº‹é¡¹
`v3`å’Œ`v5` å¯ä»¥éšæ„æ”¹åŠ¨ï¼Œä½†ä¸èƒ½ç”¨å·²ç»è¢«ä½¿ç”¨è¿‡çš„å¯„å­˜å™¨ï¼Œæ‰€ä»¥éœ€è¦ç‚¹å‡»ä¸Šé¢çš„`é“…ç¬”`å›¾æ ‡ï¼Œç‚¹å‡»`å¯„å­˜å™¨åˆ†æ`ï¼ŒæŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„å¯„å­˜å™¨ã€‚æ ¹æ®å½“å‰æ–¹æ³•ä½¿ç”¨çš„å¯„å­˜å™¨æƒ…å†µï¼Œé€‰æ‹©æœªè¢«å ç”¨çš„å¯„å­˜å™¨ï¼ˆå¦‚ `v3` å’Œ `v5`ï¼‰ï¼Œå¿…è¦æ—¶å¯è°ƒæ•´ `.registers` æ•°é‡ã€‚
:::

æœ€åç‚¹å‡»`è½¬æˆJava`æŸ¥çœ‹æ˜¯å¦æŠ¥é”™ï¼Œå¦‚æœ‰é”™è¯¯è¯·ä¿®æ­£åé‡æ–°åŠ è½½ã€‚

ğŸ’¡  **æ–°å»º `newxd` ç±»å®Œæˆ**


## âœ‚ï¸ äºŒã€è°ƒç”¨ `newxd` ç±»çš„æ–¹æ³•

---

### âœ… æ–¹æ³•ä¸€ï¼šé€šè¿‡ `HomeActivity` è°ƒç”¨

#### æ­¥éª¤ï¼š

1. åœ¨ **classes** æ–‡ä»¶ä¸­æœç´¢ `HomeActivity`ã€‚
2. å¯¼èˆªè‡³ `init()V` æ–¹æ³•ï¼ˆé€šå¸¸ä½äº `finish()V` å’Œ `onBackPressed()V` ä¹‹é—´ï¼‰ã€‚
3. åœ¨ `init()` æ–¹æ³•å‰æ’å…¥ **ä»£ç â‘ **ï¼Œåœ¨æ–¹æ³•ä½“å†…æ’å…¥ **ä»£ç â‘¡**ï¼Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š

```smali
åœ¨æ­¤å¤„æ’å…¥ä»£ç â‘ 
.method public final init()V
    .registers 11

    åœ¨æ­¤å¤„æ’å…¥ä»£ç â‘¡

    .line 1
    invoke-static {}, Lcom/androidx/jj;->u()Lcom/androidx/jj;

    .line 4
    move-result-object v0
```

#### ğŸŒºä»£ç â‘ ï¼šæ–°å¢æ–¹æ³• `checkCSPJarFileExistence`

```smali
.method private checkCSPJarFileExistence()V
    .registers 5
    
    invoke-virtual {p0}, Lcom/github/tvbox/osc/ui/activity/HomeActivity;->getFilesDir()Ljava/io/File;

    move-result-object v0

    new-instance v1, Ljava/io/File;

    const-string v2, "csp.jar"

    invoke-direct {v1, v0, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v1}, Ljava/io/File;->exists()Z
    
    move-result v3

    if-nez v3, :cond_1e

    new-instance v0, Lcom/androidx/tt0;

    invoke-direct {v0, p0}, Lcom/androidx/tt0;-><init>(Landroid/app/Activity;)V

    new-instance v1, Lcom/androidx/newxd;

    invoke-direct {v1, v0}, Lcom/androidx/newxd;-><init>(Ljava/lang/Object;)V

    invoke-virtual {v1}, Lcom/androidx/newxd;->autoupdate()V

    :cond_1e
    return-void
.end method
```

#### ğŸŒºä»£ç â‘¡ï¼šåœ¨ `init()` æ–¹æ³•å†…è°ƒç”¨

```smali
invoke-direct {p0}, Lcom/github/tvbox/osc/ui/activity/HomeActivity;->checkCSPJarFileExistence()V
```
::: warning âš ï¸æ³¨æ„äº‹é¡¹ï¼š

æ›¿æ¢"tt0"å’Œ"newxd"ï¼Œæ£€æŸ¥"autoupdate"æ–¹æ³•åå’Œæ–°å»ºçš„"newxd"ç±»åä¸­çš„"autoupdate"æ˜¯å¦ä¸€è‡´ã€‚

::: 

---

### âœ… æ–¹æ³•äºŒï¼šé€šè¿‡ `BaseActivity` è°ƒç”¨

#### æ­¥éª¤ï¼š

1. æ ¹æ®"newxd"ç±»åä¸­çš„`tt0`ï¼Œæœç´¢ `tt0` ç±»åã€‚
2. è½¬æˆ Java æŸ¥æ‰¾ `æ‰«ç è¿œç¨‹æ¨é€` å…³é”®è¯ï¼Œæ‰¾åˆ° `setAdapter` ç›¸å…³ä»£ç ã€‚
3. å¤åˆ¶ä»¥ä¸‹ä¸¤æ®µä»£ç ï¼š

```smali
new-instance p1, Lcom/androidx/xd;
```

å’Œ

```smali
invoke-direct {p1, p0, v3}, Lcom/androidx/xd;-><init>(Ljava/lang/Object;I)V
```

å¾—åˆ° `ä»£ç â‘¡`

åŸä»£ç ï¼š
```smali
    nvoke-virtual {p1, v3}, Lcom/owen/tvrecyclerview/widget/TvRecyclerView;->setAdapter(Landroidx/recyclerview/widget/RecyclerView$Adapter;)V

    .line 269
    :goto_10c
    if-eqz v1, :cond_117

    .line 271
    new-instance p1, Lcom/androidx/xd;

    .line 273
    const/4 v3, 0x3

    .line 274
    invoke-direct {p1, p0, v3}, Lcom/androidx/xd;-><init>(Ljava/lang/Object;I)V

    .line 277
    invoke-virtual {v1, p1}, Landroid/view/View;->setOnClickListener(Landroid/view/View$OnClickListener;)V
```
4. ç‚¹å‡»å¯¼èˆªæ çš„`init`é•¿æŒ‰æŸ¥çœ‹è°ƒç”¨å¤„ï¼Œåœ¨å½“å‰ç»“æœä¸­æœç´¢`getTopActivity(...)`ï¼š

å¤åˆ¶ä¸Šé¢çš„ä»£ç 
```smali
new-instance p1, Lcom/androidx/tt0;
```

å’Œä¸‹é¢çš„ä»£ç 
```smali
invoke-direct {p1, v0}, Lcom/androidx/tt0;-><init>(Landroid/app/Activity;)V
```
å¾—åˆ° `ä»£ç â‘ `
åŸä»£ç å¦‚ä¸‹ï¼š
```smali
    if-nez v0, :cond_97

    .line 134
    :cond_85
    new-instance p1, Lcom/androidx/tt0;

    .line 136
    invoke-static {}, Lcom/blankj/utilcode/util/b;->b()Landroid/app/Activity;

    .line 139
    move-result-object v0

    .line 140
    const-string v1, "getTopActivity(...)"

    .line 142
    invoke-static {v0, v1}, Lcom/androidx/xx;->g(Ljava/lang/Object;Ljava/lang/String;)V

    .line 145
    invoke-direct {p1, v0}, Lcom/androidx/tt0;-><init>(Landroid/app/Activity;)V

    .line 148
    invoke-virtual {p1}, Lcom/androidx/tt0;->show()V

    .line 151
    return-void
```

5. è¿”å› `newxd` ç±»ï¼Œå¯¼èˆªä¸­é•¿æŒ‰ `autoupdate`ï¼Œå¤åˆ¶ `å¤åˆ¶invokeä»£ç ` å¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š

```smali
invoke-virtual {v0}, Lcom/androidx/newxd;->autoupdate()V
```

6. æœç´¢ `BaseActivity`ï¼Œè¿›å…¥ `onCreate` æ–¹æ³•ï¼Œåœ¨å…¶ä¸­æ’å…¥ä»¥ä¸‹ä»£ç ï¼ˆé¡ºåºï¼šâ‘¡ â†’ â‘  â†’ â‘¢ï¼‰ï¼š

```smali
new-instance p1, Lcom/androidx/tt0;
invoke-direct {p1, v0}, Lcom/androidx/tt0;-><init>(Landroid/app/Activity;)V

new-instance p1, Lcom/androidx/xd;
invoke-direct {p1, p0, v3}, Lcom/androidx/xd;-><init>(Ljava/lang/Object;I)V

invoke-virtual {v0}, Lcom/androidx/newxd;->autoupdate()V
```

::: danger æ³¨æ„äº‹é¡¹
æ›´æ”¹ä»£ç : `tt0` å’Œ `xd`è¿˜æœ‰`å¯„å­˜å™¨`ä»¥åŠ`(Ljava/lang/Object;I)`é‡Œé¢çš„ ` I `ï¼Œå¯„å­˜å™¨åªèƒ½ç”¨v0ã€v1ã€p0æ›¿æ¢ã€‚
:::

æ›´æ”¹åä»£ç å¦‚ä¸‹ï¼š

```smali
    new-instance v0, Lcom/androidx/tt0;
    invoke-direct {v0, p0}, Lcom/androidx/tt0;-><init>(Landroid/app/Activity;)V
    new-instance v1, Lcom/androidx/newxd;
    invoke-direct {v1, v0}, Lcom/androidx/newxd;-><init>(Ljava/lang/Object;)V
    invoke-virtual {v0}, Lcom/androidx/newxd;->autoupdate()V
```
è½¬æˆjavaä»£ç æŸ¥çœ‹`onCreate`ä»£ç æœ€ç»ˆæ•ˆæœåº”ä¸ºï¼š

```java
new newxd(new tt0(this)).autoupdate();
```

**ğŸ“Œ ä»¥ä¸Šæ˜¯é€šè¿‡`HomeActivity`å’Œ`BaseActivity`è°ƒç”¨"newxd"çš„ä¸¤ç§æ–¹æ³•ã€‚**
